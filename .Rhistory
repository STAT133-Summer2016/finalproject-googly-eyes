read_html(html_address)
library(xml2)
html_address <- "https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=0&type=T"
read_html(html_address)
html_address <- "https://movie.douban.com/tag/2015美国?start=0&type=T"
read_html(html_address)
html_address <- "https://movie.douban.com/tag/2015美国?start=0&type=T"
read_html(html_address)
table <- read_html(html_address) %>%
html_nodes(xpath = "//table") %>%
html_table(fill = TRUE)
library(dplyr)
library(stringr)
library(xml2)
library(rvest)
library(readr)
library(tidyr)
library(plyr)
table <- read_html(html_address) %>%
html_nodes(xpath = "//table") %>%
html_table(fill = TRUE)
table
table <- read_html(html_address) %>%
html_nodes(xpath = "//table[@href]") %>%
html_table(fill = TRUE)
table <- read_html(html_address) %>%
html_nodes(xpath = "//table//a") %>%
html_table(fill = TRUE)
table <- read_html(html_address) %>%
html_nodes(xpath = "//table//a") %>%
table <- read_html(html_address) %>%
html_nodes(xpath = "//table//a")
table <- read_html(html_address) %>%
html_nodes(xpath = "//table")
table
table <- read_html(html_address) %>%
table <- read_html(html_address) %>%
html_nodes(xpath = "//table[@width = '100%'") %>%
html_table(fill = T)
table <- read_html(html_address) %>%
html_nodes(xpath = "//table[@width = '100%'") %>%
html_table(fill = T)
table <- read_html(html_address) %>%
html_nodes(xpath = "//table[@class]") %>%
html_table(fill = T)
table <- read_html(html_address) %>%
html_nodes(xpath = "//div[@class = 'pl2']//a") %>%
table <- read_html(html_address) %>%
html_nodes(xpath = "//div[@class = 'pl2']//a")
table <- read_html(html_address) %>%
html_nodes(xpath = "//div[@class = 'pl2']")
table <- read_html(html_address)
html_address <- "https://movie.douban.com/tag/2015美国?start=0&type=T"
table <- read_html(html_address) %>%
html_nodes(xpath = "//div[@class = 'pl2']")
html_address <- "https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=0&type=T"
html_nodes(xpath = "//div[@class = 'pl2']")
html_address <- "https://movie.douban.com/tag/2015美国?start=0&type=T"
table <- read_html(html_address) %>%
html_nodes(xpath = "//div[@class = 'pl2']")
Sys.sleep(runif(1,1,2))
table <- read_html(html_address) %>%
html_nodes(xpath = "//div[@class = 'pl2']")
doc<-htmlParse(html_address,encoding="UTF-8")
library(XML)
doc<-htmlParse(html_address,encoding="UTF-8")
table <- read_html(html_address) %>%
html_nodes(xpath = "//div[@class = 'pl2']")
html_address <- "https://movie.douban.com/tag/2015美国?start=0&type=T"
Sys.sleep(runif(1,1,2))
doc<-htmlParse(html_address,encoding="UTF-8")
rootNode<-xmlRoot(doc)
library(XML)
URL = paste0("http://movie.douban.com/top250?format=text",1:5)
Sys.sleep(runif(1,1,2))
doc<-htmlParse(URL[1],encoding="UTF-8")
rootNode<-xmlRoot(doc)
library(XML)
URL = paste0("http://movie.douban.com/top250?format=text",1:5)
Sys.sleep(runif(1,1,2))
doc<-htmlParse(URL[1],encoding="UTF-8")
rootNode<-xmlRoot(doc)
page = "https://movie.douban.com/tag/2016?start=20&type=T" %>% read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']")
page = "https://movie.douban.com/tag/2016?start=20&type=T" %>% read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']") %>%
xml_attr("href")
name
page = "https://movie.douban.com/tag/2016?start=20&type=T" %>% read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']") %>%
page = "https://movie.douban.com/tag/2016?start=20&type=T" %>% read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']")
name
page = "https://movie.douban.com/tag/2016?start=20&type=T" %>% read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']//a")
name
page = "https://movie.douban.com/tag/2016?start=20&type=T" %>% read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']//a") %>%
html_attr("href")
name
page = "https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=0&type=T" %>% read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']//a") %>%
html_attr("href")
name
page = "https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=0&type=" %>% read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']//a") %>%
html_attr("href")
name
movie = "https://movie.douban.com/subject/25954475" %>% read_html()
link = page %>%
xml_find_all(xpath = "//span[@class = 'pl']//a") %>%
html_attr("href")
movie = "https://movie.douban.com/subject/25954475" %>% read_html()
link = page %>%
xml_find_all(xpath = "//span[@class = 'pl']")
link
movie = "https://movie.douban.com/subject/25954475" %>% read_html()
link = page %>%
xml_find_all(xpath = "//a")
movie = "https://movie.douban.com/subject/25954475" %>% read_html()
link = page %>%
xml_find_all(xpath = "//div[@class = 'subject']//a")
movie = "https://movie.douban.com/subject/25954475" %>% read_html()
link = page %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//a")
movie = "https://movie.douban.com/subject/25954475" %>% read_html()
link = page %>%
movie = "https://movie.douban.com/subject/25954475" %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']")
movie = "https://movie.douban.com/subject/25954475" %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//a")
link
movie = "https://movie.douban.com/subject/25954475" %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']/a")
movie = "https://movie.douban.com/subject/25954475" %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[id = "info"]//a")
movie = "https://movie.douban.com/subject/25954475" %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@id = "info"]//a")
movie = "https://movie.douban.com/subject/25954475" %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@id = "info"]")
movie = "https://movie.douban.com/subject/25954475" %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div")
link
movie = "https://movie.douban.com/subject/25954475" %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a")
link
movie = "https://movie.douban.com/subject/25954475" %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a") %>%
html_attr("href") %>%
.[length()]
movie = "https://movie.douban.com/subject/25954475" %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a") %>%
html_attr("href")
link
str_detect(link, "[i][m][d][b]")
link[index]
index = str_detect(link, "[i][m][d][b]")
link[index]
?seq
page_num <- seq(from = 0, to = 980, by = 20)
page_num
page_num <- seq(from = 0, to = 980, by = 20)
df = data.frame(matrix(vector(), 0, 1,
dimnames=list(c(), c("html"))),
stringsAsFactors=F)
View(df)
html_address <- str_c("https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=", 20, "&type=")
html_address
index = str_detect(link, "[k][k][k][k]")
index
link <- link[index]
link
length(link)
page_num <- seq(from = 0, to = 20, by = 20)
df = data.frame(matrix(vector(), 0, 1,
dimnames=list(c(), c("html"))),
stringsAsFactors=F)
for i in(page_num) {
html_address <- str_c("https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=", i, "&type=")
page = html_address %>%
page_num <- seq(from = 0, to = 20, by = 20)
df = data.frame(matrix(vector(), 0, 1,
dimnames=list(c(), c("html"))),
stringsAsFactors=F)
for i in(page_num) {
html_address <- str_c("https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=", i, "&type=", sep = "")
page_num <- seq(from = 0, to = 20, by = 20)
df = data.frame(matrix(vector(), 0, 1,
dimnames=list(c(), c("html"))),
stringsAsFactors=F)
for (i in page_num) {
html_address <- str_c("https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=", i, "&type=", sep = "")
page = html_address %>%
read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']//a") %>%
html_attr("href")
for (j in name) {
movie = i %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a") %>%
html_attr("href")
index = str_detect(link, "[i][m][d][b]")
link <- link[index]
}
if (length(link) > 0) {
df <- rbind(link)
}
}
html_address <- str_c("https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=", 20, "&type=", sep = "")
page = html_address %>%
read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']//a") %>%
html_attr("href")
for (j in name) {
html_address <- str_c("https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=", 20, "&type=", sep = "")
page = html_address %>%
read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']//a") %>%
html_attr("href")
for (j in name) {
movie = i %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a") %>%
html_attr("href")
index = str_detect(link, "[i][m][d][b]")
link <- link[index]
if (length(link) > 0) {
df <- rbind(link)
}
}
html_address <- str_c("https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=", 20, "&type=", sep = "")
page = html_address %>%
read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']//a") %>%
html_attr("href")
for (j in name) {
movie = j %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a") %>%
html_attr("href")
index = str_detect(link, "[i][m][d][b]")
link <- link[index]
if (length(link) > 0) {
df <- rbind(link)
}
}
View(df)
View(df)
html_address <- str_c("https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=", 20, "&type=", sep = "")
page = html_address %>%
read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']//a") %>%
html_attr("href")
name
movie = "https://movie.douban.com/subject/25752261/" %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a") %>%
html_attr("href")
index = str_detect(link, "[i][m][d][b]")
link <- link[index]
if (length(link) > 0) {
df <- rbind(link)
}
View(df)
df = data.frame(matrix(vector(), 0, 1,
dimnames=list(c(), c("link"))),
stringsAsFactors=F)
movie = "https://movie.douban.com/subject/25752261/" %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a") %>%
html_attr("href")
index = str_detect(link, "[i][m][d][b]")
link <- link[index]
if (length(link) > 0) {
df <- rbind(link)
}
df = data.frame(matrix(vector(), 0, 1,
dimnames=list(c(), c("link"))),
stringsAsFactors=F)
View(df)
movie = "https://movie.douban.com/subject/25752261/" %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a") %>%
html_attr("href")
index = str_detect(link, "[i][m][d][b]")
link <- link[index]
if (length(link) > 0) {
df <- rbind(data.framd(link))
}
movie = "https://movie.douban.com/subject/25752261/" %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a") %>%
html_attr("href")
index = str_detect(link, "[i][m][d][b]")
link <- link[index]
if (length(link) > 0) {
df <- rbind(data.frame(link))
}
View(df)
page_num <- seq(from = 0, to = 20, by = 20)
df = data.frame(matrix(vector(), 0, 1,
dimnames=list(c(), c("link"))),
stringsAsFactors=F)
for (i in page_num) {
html_address <- str_c("https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=", i, "&type=", sep = "")
page = html_address %>%
read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']//a") %>%
html_attr("href")
for (j in name) {
movie = j %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a") %>%
html_attr("href")
index = str_detect(link, "[i][m][d][b]")
link <- link[index]
if (length(link) > 0) {
df <- rbind(data.frame(link))
}
}
}
View(df)
View(df)
page_num <- seq(from = 0, to = 20, by = 20)
df = data.frame(matrix(vector(), 0, 1,
dimnames=list(c(), c("link"))),
stringsAsFactors=F)
for (i in page_num) {
html_address <- str_c("https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=", i, "&type=", sep = "")
page = html_address %>%
read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']//a") %>%
html_attr("href")
for (j in name) {
movie = j %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a") %>%
html_attr("href")
index = str_detect(link, "[i][m][d][b]")
link <- link[index]
if (length(link) > 0) {
df <- rbind(df, data.frame(link))
}
}
}
View(df)
page_num <- seq(from = 0, to = 980, by = 20)
df = data.frame(matrix(vector(), 0, 1,
dimnames=list(c(), c("link"))),
stringsAsFactors=F)
for (i in page_num) {
html_address <- str_c("https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=", i, "&type=", sep = "")
page = html_address %>%
read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']//a") %>%
html_attr("href")
for (j in name) {
movie = j %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a") %>%
html_attr("href")
index = str_detect(link, "[i][m][d][b]")
link <- link[index]
if (length(link) > 0) {
df <- rbind(df, data.frame(link))
}
}
}
View(df)
page_num <- seq(from = 80, to = 100, by = 20)
df = data.frame(matrix(vector(), 0, 1,
dimnames=list(c(), c("link"))),
stringsAsFactors=F)
for (i in page_num) {
html_address <- str_c("https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=", i, "&type=", sep = "")
page = html_address %>%
read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']//a") %>%
html_attr("href")
for (j in name) {
movie = j %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a") %>%
html_attr("href")
index = str_detect(link, "[i][m][d][b]")
link <- link[index]
if (length(link) > 0) {
df <- rbind(df, data.frame(link))
}
}
}
View(df)
for (i in page_num) {
start = 0
end = 980
page_num <- seq(from = start, to = end, by = 20)
df = data.frame(matrix(vector(), 0, 1,
dimnames=list(c(), c("link"))),
stringsAsFactors=F)
for (i in page_num) {
html_address <- str_c("https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=", i, "&type=", sep = "")
print(str_c(as.character(round((i - start)/(end - start))), "%"))
page = html_address %>%
read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']//a") %>%
html_attr("href")
for (j in name) {
movie = j %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a") %>%
html_attr("href")
index = str_detect(link, "[i][m][d][b]")
link <- link[index]
if (length(link) > 0) {
df <- rbind(df, data.frame(link))
}
}
}
end = 20
start = 0
end = 20
page_num <- seq(from = start, to = end, by = 20)
df = data.frame(matrix(vector(), 0, 1,
dimnames=list(c(), c("link"))),
stringsAsFactors=F)
for (i in page_num) {
html_address <- str_c("https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=", i, "&type=", sep = "")
print(str_c(as.character(round((i - start)/(end - start))), "%"))
page = html_address %>%
read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']//a") %>%
html_attr("href")
for (j in name) {
movie = j %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a") %>%
html_attr("href")
index = str_detect(link, "[i][m][d][b]")
link <- link[index]
if (length(link) > 0) {
df <- rbind(df, data.frame(link))
}
}
}
start = 0
end = 20
page_num <- seq(from = start, to = end, by = 20)
df = data.frame(matrix(vector(), 0, 1,
dimnames=list(c(), c("link"))),
stringsAsFactors=F)
for (i in page_num) {
html_address <- str_c("https://movie.douban.com/tag/2015%20%E7%BE%8E%E5%9B%BD?start=", i, "&type=", sep = "")
print(str_c(as.character(round((i - start)/(end - start)*100, 2)), "%"))
page = html_address %>%
read_html()
name = page %>%
xml_find_all(xpath = "//div[@class = 'pl2']//a") %>%
html_attr("href")
for (j in name) {
movie = j %>% read_html()
link = movie %>%
xml_find_all(xpath = "//div[@class = 'subject clearfix']//div//a") %>%
html_attr("href")
index = str_detect(link, "[i][m][d][b]")
link <- link[index]
if (length(link) > 0) {
df <- rbind(df, data.frame(link))
}
}
}
View(df)
